a=c(01,2,2,23,3)
a
b=c(21,22,22,223,23)
m=lm (a,b)
m=lm (a~b)
m
q()
library(xml)
install.packages(xml)
install.packages("xml)
")"
""
install.packages("xml")
install.packages("XML")
setwd("/home/user/ost4sem/exercise/SpatialAnalysisTutorials/climate/RCM")
library(ncdf)
library(rasterVis)
library(sp)
library(rgdal)
library(reshape)
library(lattice)
library(xtable)
library(plyr)
system("bash ../CMIP5/wget-20131009120214.sh -n -s")
system("bash ../CMIP5/wget-20131009120214.sh -h")
system("bash ../CMIP5/wget-20131009120214.sh -n -s")
system("cdo -V")
system("cdo -V")
system("cdo vardes ../data/gfdl_RCM3_Future.nc")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future_tmean.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_tmean.nc &")
system("qgis ../data/gfdl_RCM3_Future.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_tmean.nc &")
system("cdo vardes ../data/GFDL_Future.nc")
system("/usr/local/PanoplyJ/panoply.sh ../data/GFDL_Future.nc &")
system("cdo selvar,tmean ../data/GFDL_Future.nc GFDL_Future_tmean.nc")
system("/usr/local/PanoplyJ/panoply.sh GFDL_Future_tmean.nc &")
system("/usr/local/PanoplyJ/panoply.sh GFDL_Future_tmean.nc &")
system("cdo selvar,tmean ../data/GFDL_Future.nc GFDL_Future_tmean.nc")
system("/usr/local/PanoplyJ/panoply.sh GFDL_Future_tmean.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/GFDL_Future.nc &")
system("cdo vardes ../data/GFDL_Future.nc")
system("cdo selvar,tmean ../data/GFDL_Future.nc GFDL_Future_tmean.nc")
system("/usr/local/PanoplyJ/panoply.sh GFDL_Future_tmean.nc &")
system("cdo timmean -selvar,tmean ../data/GFDL_Future.nc GFDL_Future_mat.nc")
system("cdo -V")
system("cdo vardes ../data/gfdl_RCM3_Future.nc")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("cdo selvar,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_tmean.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_tmean.nc &")
system("cdo timmean -selvar,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_mat.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("cdo timmean -selvar,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_mat.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_tmean.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("/usr/local/PanoplyJ/panoply.sh ../data/gfdl_RCM3_Future.nc &")
system("cdo selvar,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_tmean.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_tmean.nc &")
system("cdo timmean -selvar,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_mat.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_Future_mat.nc &")
system("cdo timmean -selvar,tmean ../data/gfdl_RCM3_Current.nc gfdl_RCM3_Current_mat.nc")
system("cdo sub gfdl_RCM3_Future_mat.nc gfdl_RCM3_Current_mat.nc gfdl_RCM3_mat_dif.nc")
system("/usr/local/PanoplyJ/panoply.sh gfdl_RCM3_mat_dif.nc &")
system("cdo sub -timmean -selvar,tmean ../data/gfdl_RCM3_Future.nc -timmean -selvar,tmean ../data/gfdl_RCM3_Current.nc gfdl_RCM3_mat_dif.nc")
mat_dif=raster("gfdl_RCM3_mat_dif.nc",varname="tmean",band=1)
ne=as(readOGR("../data/NewEngland.shp","NewEngland"),"SpatialLines")
levelplot(mat_dif,margin=F)+layer(sp.lines(ne))
levelplot(mat_dif,margin=F, main="Projected Change in Mean Annual Temperatures")+layer(sp.lines(ne))
levelplot(mat_dif,margin=F,
main="Projected Change in Mean Annual Temperatures (mid-century - current)",
sub="GCM: GFDL    RCM: RCM3")+layer(sp.lines(ne))
hist(mat_dif,col="grey",main="Change (future-current) \n Mean Annual Temperature",
xlab="Change (Degrees C)",xlim=c(1.3,2.5))
system("cdo sub -timmean ../data/GFDL_Future.nc -timmean ../data/GFDL_Current.nc GFDL_dif.nc")
c(levelplot(gcm[[1]],margin=F,main="Projected change in \n mean annual temperature (C)"),
levelplot(rcm[[1]],margin=F))+layer(sp.lines(ne))
c(levelplot(gcm[[2]],margin=F,main="Projected change in \n mean annual precipitation (mm)"),
levelplot(rcm[[2]],margin=F))+layer(sp.lines(ne))
gcm=brick(raster("GFDL_dif.nc",varname="tmean"),raster("GFDL_dif.nc",varname="ptot"))
rcm=brick(raster("GFDL_RCM3_dif.nc",varname="tmean"),raster("GFDL_RCM3_dif.nc",varname="ptot"))
c(levelplot(gcm[[1]],margin=F,main="Projected change in \n mean annual temperature (C)"),
levelplot(rcm[[1]],margin=F))+layer(sp.lines(ne))
c(levelplot(gcm[[2]],margin=F,main="Projected change in \n mean annual precipitation (mm)"),
levelplot(rcm[[2]],margin=F))+layer(sp.lines(ne))
rcm=brick(raster("GFDL_RCM3_dif.nc",varname="tmean"),raster("GFDL_RCM3_dif.nc",varname="ptot"))
system("cdo sub -timmean ../data/gfdl_RCM3_Future.nc -timmean ../data/gfdl_RCM3_Current.nc GFDL_RCM3_dif.nc")
gcm=brick(raster("GFDL_dif.nc",varname="tmean"),raster("GFDL_dif.nc",varname="ptot"))
rcm=brick(raster("GFDL_RCM3_dif.nc",varname="tmean"),raster("GFDL_RCM3_dif.nc",varname="ptot"))
c(levelplot(gcm[[1]],margin=F,main="Projected change in \n mean annual temperature (C)"),
levelplot(rcm[[1]],margin=F))+layer(sp.lines(ne))
c(levelplot(gcm[[2]],margin=F,main="Projected change in \n mean annual precipitation (mm)"),
levelplot(rcm[[2]],margin=F))+layer(sp.lines(ne))
system("cdo sub -yseasmean ../data/GFDL_Future.nc -yseasmean ../data/GFDL_Current.nc  gfdl_seasdif.nc")
difseas=brick("gfdl_seasdif.nc",varname="tmean",band=1:4)
names(difseas)=c("Winter","Spring","Summer","Fall")
levelplot(difseas,col.regions=rev(heat.colors(20)))+layer(sp.lines(ne))
densityplot(difseas,auto.key=T,xlab="Temperature Change (C)")
bwplot(difseas,ylab="Temperature Change (C)",xlab="Season",scales=list(y=list(lim=c(1,5))))
splom(difseas,colramp=colorRampPalette("blue"))
print(xtable(layerStats(difseas,stat="pearson")[[1]],
caption="Pearson Correlation between seasonal change",digits=3), type = "html")
layerStats(difseas,stat="pearson")[[1]]
system("cdo -s showyear ../data/gfdl_RCM3_Current.nc")
system("cdo -s showyear ../data/gfdl_RCM3_Future.nc")
cyears=system("cdo -s showyear ../data/gfdl_RCM3_Current.nc",intern=T)
cyears
cyears
cyears=as.numeric(strsplit(cyears," ")[[1]][-c(1:2)])
cyears
cyears=as.numeric(strsplit(system("cdo -s showyear ../data/gfdl_RCM3_Current.nc",intern=T)," ")[[1]][-c(1,2)])
cyears
fyears=as.numeric(strsplit(system("cdo -s showyear ../data/gfdl_RCM3_Future.nc",intern=T)," ")[[1]][-c(1,2)])
fyears
setwd("/home/user/ost4sem/exercise/SpatialAnalysisTutorials/climate/RCM")
library(ncdf)
library(rasterVis)
library(sp)
library(rgdal)
library(reshape)
library(lattice)
library(xtable)
library(plyr)
bwplot(value~factor(as.character(period),ordered=T)|variable,data=d,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance.  If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
future=as(raster("gfdl_RCM3_Future_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(future@data)="CDD"
str(future)
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current=as(raster("gfdl_RCM3_Current_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(current@data)="CDD"
current$R20mm=as(raster("gfdl_RCM3_Current_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAP=as(raster("gfdl_RCM3_Current_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
current$CFD=as(raster("gfdl_RCM3_Current_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAT=as(raster("gfdl_RCM3_Current_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
current$CSU=as(raster("gfdl_RCM3_Current_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
fullgrid(future)=F
fullgrid(current)=F
ne=readOGR("../data/NewEngland.shp","NewEngland")
future=future[!is.na(overlay(future,ne)),]
current=current[!is.na(overlay(current,ne)),]
future=future[!is.na(over(future,ne)),]
future=future[!is.na(overlay(future,ne)),]
over(future,ne)
ne
projection(ne)
projection(ne)="+proj=longlat +datum=WGS84 +no_defs +ellps=GRS80 +towgs84=0,0,0"
future=future[!is.na(over(future,ne)),]
future
projection(ne)="+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
future=future[!is.na(over(future,ne)),]
projection(ne)="+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"
projection(ne)
future=future[!is.na(over(future,ne)),]
future
projection(future)
projection(ne)
projection(ne)="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
future=future[!is.na(over(future,ne)),]
future=future[!is.na(overlay(future,ne)),]
current=current[!is.na(overlay(current,ne)),]
future=future[!is.na(over(future,ne)),]
future=as(raster("gfdl_RCM3_Future_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(future@data)="CDD"
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
fullgrid(future)=F
fullgrid(current)=F
ne=readOGR("../data/NewEngland.shp","NewEngland")
projection(ne)="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
### now keep only pixels that are inside the polygon
future=future[!is.na(over(future,ne)),]
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
str(future)
future=future[!is.na(over(future,ne)),]
str(future)
future=as(raster("gfdl_RCM3_Future_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(future@data)="CDD"
## You can see all the information in that object by running
str(future)
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
ne=readOGR("../data/NewEngland.shp","NewEngland")
projection(ne)="+proj=longlat +datum=WGS84 +ellps=WGS84 +towgs84=0,0,0"
plot(future)
spplot(future,zcol="CFD")
future=future[!is.na(over(future,ne)),]
future=future[!is.na(overlay(future,ne)),]
future=as(raster("gfdl_RCM3_Future_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(future@data)="CDD"
## You can see all the information in that object by running
str(future)
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current=as(raster("gfdl_RCM3_Current_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(current@data)="CDD"
current$R20mm=as(raster("gfdl_RCM3_Current_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAP=as(raster("gfdl_RCM3_Current_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
current$CFD=as(raster("gfdl_RCM3_Current_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAT=as(raster("gfdl_RCM3_Current_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
current$CSU=as(raster("gfdl_RCM3_Current_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
futurel=cbind(period="future",coordinates(future),future@data)
currentl=cbind(period="current",coordinates(current),current@data)
d=rbind(futurel,currentl)
d=melt(d,measure.vars=c("CDD","CFD","R20mm","MAP","MAT","CSU"))
head(d)
bwplot(value~factor(as.character(period),ordered=T)|variable,data=d,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance.  If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
d2=cast(d,period+s1+s2~variable)
head(d2)
xyplot(MAT~CFD,groups=period,data=d2,type=c("p","r","g"),auto.key=T,
ylab="Mean Annual Temperature",xlab="Consecutive Frost Days",
main="Climate metric relationship between current and future")
lm_CFD=lm(MAT~CFD*period,data=d2)
summary(lm_CFD)
xyplot(MAT~CSU,groups=period,data=d2,type=c("p","r","g"),auto.key=T,
ylab="Mean Annual Temperature",xlab="Consecutive Warm Days",
main="Climate metric relationship between current and future")
lm_CSU=lm(MAT~CSU*period,data=d2)
summary(lm_CSU)
xyplot(MAP~CDD,groups=period,data=d2,type=c("p","r","g"),pch=16,auto.key=T,
ylab="Mean Annual Precipitation",xlab="Consecutive Dry Days",
main="Climate metric relationship between current and future")
lm_CDD=lm(MAP~CDD*period,data=d2)
summary(lm_CDD)
xyplot(MAP~R20mm,groups=period,data=d2,type=c("p","r"),auto.key=T,
ylab="Mean Annual Precipitation",xlab="Number of Rainy Days",
main="Climate metric relationship between current and future")
lm_R20mm=lm(MAP~R20mm*period,data=d2)
summary(lm_R20mm)
writeGDAL(future,"future.tif")
head(future@data)
for(i in colnames(future@data)){
temp=future #make a copy
temp@data=data.frame(future@data[,i]) #copy only the variable of interest
writeGDAL(future,paste("future_",i,".tif",sep="")) #write it
}
for(i in colnames(current@data)){
temp=current #make a copy
temp@data=data.frame(current@data[,i]) #copy only the variable of interest
writeGDAL(current,paste("current_",i,".tif",sep="")) #write it
}
list.files(pattern="*.tif")
list.files(,pattern="*CFD*nc")
list.files(,pattern=".*CFD.*nc")
ne=readOGR("../data/NewEngland.shp","NewEngland")
futurel=cbind(period="future",coordinates(future),future@data)
currentl=cbind(period="current",coordinates(current),current@data)
d=rbind(futurel,currentl)
d=melt(d,measure.vars=c("CDD","CFD","R20mm","MAP","MAT","CSU"))
head(d)
See how we added a column for time period, latitude, longitude, variable, and value?
That makes it easy to create summary plots:
ne=readOGR("../data/NewEngland.shp","NewEngland")
Look at current and future values of each metric
bwplot(value~factor(as.character(period),ordered=T)|variable,data=d,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
d=rbind(futurel,currentl)
head(d)
head(future)
ne=readOGR("../data/NewEngland.shp","NewEngland")
futurel=cbind(period="future",coordinates(future),future@data)
currentl=cbind(period="current",coordinates(current),current@data)
d=rbind(futurel,currentl)
dl=melt(d,measure.vars=c("CDD","CFD","R20mm","MAP","MAT","CSU"))
bwplot(value~factor(as.character(period),ordered=T)|variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
head(dl)
levelplot(value~s2*s1|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",notch=T,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics"))
combineLimits(levelplot(log(value)~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics"))
combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics"))
useOuterStrips(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics"))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable=="CFD",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics"))
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable=="CFD",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable=="CFD",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")+layer(sp.lines(ne))
ne=as(readOGR("../data/NewEngland.shp","NewEngland"),"SpatialLines")
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable=="CFD",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")+layer(sp.lines(ne))
v="CFD"
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v)+layer(sp.lines(ne))
)
v="CFD"
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))
lapply(unique(dl$variable),function(v){
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))})
plots=lapply(unique(dl$variable),function(v){
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))})
useOuterStrips(combineLimits(plots))
useOuterStrips(combineLimits(ldaply(plots,c))
)
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
plots=lapply(unique(dl$variable),function(v){
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))})
do.call(c,lapply(unique(dl$variable),function(v){
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))})
)
print(do.call(c,lapply(unique(dl$variable),function(v){
levelplot(value~s1*s2|factor(as.character(period),ordered=T),data=dl[dl$variable==v,],scales=list(relation="free"),auto.key=T,
ylab="Latitude",xlab="Longitude",asp=1,
main=paste("Comparison of Current and Future values of",v))+layer(sp.lines(ne))})))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=quantiles(dl$value,seq(0,1,100)),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=quantile(dl$value,seq(0,1,100)),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=quantile(dl$value,seq(0,1,len=100)),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl,scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=unique(quantile(dl$value,seq(0,1,len=100))),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl[dl$variable!="MAP",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=unique(quantile(dl$value,seq(0,1,len=100))),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl[dl$variable!="MAP",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=unique(quantile(dl$value[dl$variable!="MAP"],seq(0,1,len=100))),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl[dl$variable!="MAP",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=unique(quantile(dl$value[dl$variable!="MAP"],seq(0,1,len=100))),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))+layer(sp.lines(ne))
useOuterStrips(combineLimits(levelplot(value~s1*s2|factor(as.character(period),ordered=T)+variable,data=dl[dl$variable!="MAP",],scales=list(relation="free"),auto.key=T,
ylab="Metric Value",xlab="Time Period",asp=1,col.regions=rainbow(100),at=unique(quantile(dl$value[dl$variable!="MAP"],seq(0,1,len=100))),
sub="The notches are a rough indicator of statistical significance. \n If the notches do not overlap, the means are probably different.",
main="Comparison of Current and Future values of various climate metrics")))+layer(sp.lines(ne))
for(i in colnames(future@data)){
temp=future #make a copy
temp@data=data.frame(temp@data[,i]) #copy only the variable of interest
writeGDAL(temp,paste("future_",i,".tif",sep="")) #write it
}
for(i in colnames(current@data)){
temp=current #make a copy
temp@data=data.frame(temp@data[,i]) #copy only the variable of interest
writeGDAL(temp,paste("current_",i,".tif",sep="")) #write it
}
