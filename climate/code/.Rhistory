a=c(01,2,2,23,3)
a
b=c(21,22,22,223,23)
m=lm (a,b)
m=lm (a~b)
m
q()
library(xml)
install.packages(xml)
install.packages("xml)
")"
""
install.packages("xml")
install.packages("XML")
system("cdo timmean gfdl_RCM3_Future_CFD.nc gfdl_RCM3_Future_CFD_mean.nc")
setwd("/home/user/ost4sem/exercise/SpatialAnalysisTutorials/climate/RCM")
library(ncdf)
library(rasterVis)
library(sp)
library(rgdal)
library(reshape)
library(lattice)
library(xtable)
library(plyr)
system("cdo -s showyear ../data/gfdl_RCM3_Current.nc")  # -s tells it to 'be quiet' and only report the values
system("cdo -s showyear ../data/gfdl_RCM3_Future.nc")
cyears=system("cdo -s showyear ../data/gfdl_RCM3_Current.nc",intern=T)
cyears
cyears=as.numeric(strsplit(cyears," ")[[1]][-c(1:2)])
cyears
cyears=as.numeric(strsplit(system("cdo -s showyear ../data/gfdl_RCM3_Current.nc",intern=T)," ")[[1]][-c(1,2)])
cyears
fyears=as.numeric(strsplit(system("cdo -s showyear ../data/gfdl_RCM3_Future.nc",intern=T)," ")[[1]][-c(1,2)])
fyears
c1=paste("-eca_cfd -selyear,",cyears," -selname,tmin ../data/gfdl_RCM3_Current.nc ",sep="",collapse=" ")
c1
hd=paste("cdo mergetime ",c1, " ../data/gfdl_RCM3_Current_CFD.nc",sep="")
## now look at that line, see how it added "cdo mergetime" to the c1 string:
hd
system(paste("cdo ",paste("mergetime ",
paste("-eca_cfd -selyear,",fyears,
" -selname,tmin ../data/gfdl_RCM3_Future.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Future_CFD.nc",sep=""))
system("cdo timmean gfdl_RCM3_Future_CFD.nc gfdl_RCM3_Future_CFD_mean.nc")
system("cdo timmean gfdl_RCM3_Current_CFD.nc gfdl_RCM3_Current_CFD_mean.nc")
getwd()
tempdir()
hd=paste("cdo mergetime ",c1, " gfdl_RCM3_Current_CFD.nc",sep="")
system(hd)
system("cdo timmean gfdl_RCM3_Future_CFD.nc gfdl_RCM3_Future_CFD_mean.nc")
system("cdo timmean gfdl_RCM3_Current_CFD.nc gfdl_RCM3_Current_CFD_mean.nc")
list.files()
list.files(,pattern="nc")
system(paste("cdo ",paste("mergetime ",
paste("-eca_csu -selyear,",cyears,
" -selname,tmax ../data/gfdl_RCM3_Current.nc ",sep="",
collapse=" ")),
" gfdl_RCM3_Current_CSU.nc",sep=""))
system(paste("cdo ",paste("mergetime ",
paste("-eca_csu -selyear,",fyears,
" -selname,tmax ../data/gfdl_RCM3_Future.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Future_CSU.nc",sep=""))
system("cdo timmean gfdl_RCM3_Future_CSU.nc gfdl_RCM3_Future_CSU_mean.nc")
system("cdo timmean gfdl_RCM3_Current_CSU.nc gfdl_RCM3_Current_CSU_mean.nc")
system(paste("cdo ",paste("mergetime ",
paste("-eca_cdd -selyear,",cyears,
" -selname,ptot ../data/gfdl_RCM3_Current.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Current_CDD.nc",sep=""))
system(paste("cdo ",paste("mergetime ",
paste("-eca_cdd -selyear,",fyears,
" -selname,ptot ../data/gfdl_RCM3_Future.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Future_CDD.nc",sep=""))
system("cdo timmean gfdl_RCM3_Future_CDD.nc gfdl_RCM3_Future_CDD_mean.nc")
system("cdo timmean gfdl_RCM3_Current_CDD.nc gfdl_RCM3_Current_CDD_mean.nc")
system(paste("cdo ",paste("mergetime ",
paste("-eca_r20mm -selyear,",cyears,
" -selname,ptot ../data/gfdl_RCM3_Current.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Current_r20mm.nc",sep=""))
## Future
system(paste("cdo ",paste("mergetime ",
paste("-eca_r20mm -selyear,",fyears,
" -selname,ptot ../data/gfdl_RCM3_Future.nc ",sep="",collapse=" ")),
" gfdl_RCM3_Future_r20mm.nc",sep=""))
## Mean within each period:
system("cdo timmean gfdl_RCM3_Future_r20mm.nc gfdl_RCM3_Future_r20mm_mean.nc")
system("cdo timmean gfdl_RCM3_Current_r20mm.nc gfdl_RCM3_Current_r20mm_mean.nc")
system(paste("cdo -subc,273.15 -timmean -selname,tmean ../data/gfdl_RCM3_Current.nc gfdl_RCM3_Current_MAT.nc",sep=""))
system(paste("cdo -subc,273.15 -timmean -selname,tmean ../data/gfdl_RCM3_Future.nc gfdl_RCM3_Future_MAT.nc",sep=""))
system(paste("cdo timmean -yearsum -selname,ptot gfdl_RCM3_Current.nc  gfdl_RCM3_Current_MAP.nc",sep=""))
system(paste("cdo timmean -yearsum -selname,ptot gfdl_RCM3_Future.nc  gfdl_RCM3_Future_MAP.nc",sep=""))
system(paste("cdo timmean -yearsum -selname,ptot ../data/gfdl_RCM3_Current.nc  gfdl_RCM3_Current_MAP.nc",sep=""))
system(paste("cdo timmean -yearsum -selname,ptot ../data/gfdl_RCM3_Future.nc  gfdl_RCM3_Future_MAP.nc",sep=""))
future=as(raster("gfdl_RCM3_Future_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(future@data)="CDD"
str(future)
future$R20mm=as(raster("gfdl_RCM3_Future_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAP=as(raster("gfdl_RCM3_Future_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
future$CFD=as(raster("gfdl_RCM3_Future_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
future$MAT=as(raster("gfdl_RCM3_Future_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
future$CSU=as(raster("gfdl_RCM3_Future_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current=as(raster("gfdl_RCM3_Current_CDD_mean.nc",
varname="consecutive_dry_days_index_per_time_period"),
"SpatialGridDataFrame"); colnames(current@data)="CDD"
current$R20mm=as(raster("gfdl_RCM3_Current_r20mm_mean.nc",
varname="very_heavy_precipitation_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAP=as(raster("gfdl_RCM3_Current_MAP.nc",
varname="ptot"),
"SpatialGridDataFrame")@data[,1]
current$CFD=as(raster("gfdl_RCM3_Current_CFD_mean.nc",
varname="consecutive_frost_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
current$MAT=as(raster("gfdl_RCM3_Current_MAT.nc",
varname="tmean"),
"SpatialGridDataFrame")@data[,1]
current$CSU=as(raster("gfdl_RCM3_Current_CSU.nc",
varname="consecutive_summer_days_index_per_time_period"),
"SpatialGridDataFrame")@data[,1]
fullgrid(future)=F
fullgrid(current)=F
ne=readOGR("NewEngland.shp","NewEngland")
future=future[!is.na(overlay(future,ne)),]
current=current[!is.na(overlay(current,ne)),]
ne=readOGR("NewEngland.shp","../data/NewEngland")
ne=readOGR("../data/NewEngland.shp","NewEngland")
future=future[!is.na(overlay(future,ne)),]
current=current[!is.na(overlay(current,ne)),]
futurel=cbind(period="future",coordinates(future),future@data)
currentl=cbind(period="current",coordinates(current),current@data)
d=rbind(futurel,currentl)
d=melt(d,measure.vars=c("CDD","CFD","R20mm","MAP","MAT","CSU"))
## now look at the d object
head(d)
